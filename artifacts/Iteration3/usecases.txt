Use Cases – Iteration 3

----------------------------------------------------------------------------

Use Case #0: Load Records

Primary Actor: System
Goal: Load train routes from a database into system memory.

Preconditions:
• Database with route data exists and is accessible.
• Database connection is available.
• ROUTE table is populated with valid data.

Postconditions:
• All routes are loaded into a catalog in working memory.
• System is ready to process search queries.

Main Success Scenario:
	1.	System establishes a connection to the database.
	2.	System queries the ROUTE table for all records.
	3.	System parses each database row into Record objects.
	4.	System stores all records in the routes catalog in memory.
	5.	System confirms successful loading with the total route count.

----------------------------------------------------------------------------

Use Case #1: Search for Connections

Primary Actor: Client
Goal: Find train connections that match selected search criteria.

Preconditions:
• Train route data is loaded from the database into memory.

Postconditions:
• Matching connections are displayed to the client.
• Connections with invalid layover durations are filtered out according to the layover policy.
• Results can be sorted according to client preference.
• Client can proceed to book a selected connection.

Main Success Scenario:
	1.	Client opens the search interface.
	2.	Client enters search parameters (departure city, arrival city, day of operation, train type, maximum price, departure time range, maximum duration).
	3.	System searches for direct routes matching all criteria.
	4.	If direct routes are found, client selects sorting option and system displays sorted results.
	5.	If no direct routes are found, system searches for multi-leg connections (1-stop and 2-stop) considering transfer times and day compatibility.
	6.	For each multi-leg connection found, system validates layover durations as follows:
  • Daytime layovers (06:00–22:00): Must be between 10 minutes and 2 hours.
  • After-hours layovers (22:00–06:00): Must be between 10 minutes and 30 minutes.
  • Connections violating these policies are excluded from results.
	7.	Client optionally selects sorting criterion.
	8.	System displays all valid matching connections with leg details, transfer times, and totals.
	9.	Client can proceed to book a connection or exit the search.

----------------------------------------------------------------------------

Use Case #2: Book a Trip

Primary Actor: Client
Goal: Book a trip for one or more travellers on a selected connection.

Preconditions:
• Client has performed a search and identified a desired connection.
• Connection has available capacity (assumed unlimited in this iteration).
• Database connection is available.

Postconditions:
• A trip is created with a unique numerical ID (auto-generated by the database).
• One or more reservations are created (one per traveller).
• Each reservation is documented by a ticket with a unique numerical ID.
• All travellers are registered as clients in the database.
• Trip and all reservations are persisted to the database.
• System displays booking confirmation.

Main Success Scenario:
	1.	Client indicates desire to book a specific connection from search results.
	2.	System prompts for number of travellers.
	3.	For each traveller, system collects name, age, and ID (passport or government ID).
	4.	System begins a database transaction.
	5.	System checks whether each traveller already exists in the CLIENT table.
	6.	If new, system inserts a record in the CLIENT table and retrieves client_id.
	7.	System inserts a record in the TRIP table and retrieves the auto-generated trip_id.
	8.	For each connection leg in the trip, system inserts a record in the CONNECTION table.
	9.	For each traveller, system inserts records in the TICKET and RESERVATION tables linking trip_id, client_id, and connection_id.
	10.	System commits the transaction.
	11.	System displays booking confirmation with trip_id, route details, and ticket numbers.

Scenario 1 – Family of Four:
• Four family members enter their credentials (names, ages, IDs).
• Client selects the desired connection.
• System books a single trip containing four reservations.
• Each reservation has a unique ticket number.
• All four reservations reference the same connection.
• Trip has one unique numerical trip_id (e.g., 1001).

Scenario 2 – Solo Traveller:
• One traveller enters their credentials.
• Client selects the desired connection.
• System books a trip containing a single reservation.
• One ticket is issued.
• Trip has one unique numerical trip_id (e.g., 1002).

----------------------------------------------------------------------------

Use Case #3: View Trips

Primary Actor: Client
Goal: View all trips associated with a client’s credentials.

Preconditions:
• Client has valid credentials (last name and ID).
• Database connection is available.

Postconditions:
• All trips for the client are retrieved from the database.
• Trips are displayed with full details including numerical trip IDs.
• Trips are categorized as current (today or future) or past (history).

Main Success Scenario:
	1.	Client selects “View My Trips” option.
	2.	System prompts for client credentials (last name and traveller ID).
	3.	Client enters credentials.
	4.	System queries the CLIENT table for a matching traveller record.
	5.	System retrieves all reservations associated with the traveller.
	6.	System extracts all related trip_ids.
	7.	For each trip_id, system queries TRIP, RESERVATION, CONNECTION, TICKET, and CLIENT tables to assemble complete trip information.
	8.	System displays all trips with trip_id, booking date, passenger details, ticket numbers, route information, days of operation, and pricing.
	9.	Client reviews trip information.